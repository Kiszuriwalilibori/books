"use strict";(self.webpackChunkbooks=self.webpackChunkbooks||[]).push([[744],{744:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var r=n(9379),o=n(5544),i=n(5043),s=n(8222),a=n.n(s),u=n(7508),l=n(3516),c=n(3216),d=n(7861),f=n(4073),b=n(238),h=n(6788),k=n(8049),m=n(4558);var w=n(579);var v=(0,u.Ng)((function(e){return{isLoading:e.loading.isLoading}}),(function(e){return{fetchFromFavorites:function(){return e((function(e){try{var t=new h.v_((function(e){return e.kind===m.XI})).getAll();e((0,k.storeBooks)(t)),e((0,k.setIsFromNetwork)(!1))}catch(r){var n=r instanceof Error?r.message:"Podczas pr\xf3by pobrania ulubionych wyst\u0105pi\u0142 b\u0142\u0105d";e((0,k.showError)({isError:!0,errorMessage:n}))}}))}}}))((function(e){var t=(0,c.Zp)(),n=e.fetchFromFavorites,r=e.isLoading,o=(0,b.cs)().favoriteBooks;return(0,w.jsx)(f.$n,{disabled:!o.areNotEmpty()||r,className:"button--favorites",onClick:function(){n(),t(d.A.books)},children:"Ulubione"})})),p=n(45),g=n(8780),j=["isDisabled","label","name"];function y(e){e.target.focus()}var A,x=function(e){var t=e.isDisabled,n=e.label,o=e.name,i=(0,p.A)(e,j);return(0,w.jsx)(f.m_,{role:"tooltip",title:"Nie mniej ni\u017c dwa znaki w tym jeden alfanumeryczny",placement:"top",children:(0,w.jsx)(g.A,(0,r.A)({disabled:t,"aria-label":"input field for ".concat(o," field"),label:n,id:o,size:"small",variant:"outlined",onMouseEnter:y},i))})},E=n(3555),S=n.n(E),C=n(6665),N=n.n(C),T="https://www.googleapis.com/books/v1/volumes?q=",z="&maxResults=40",F="&startIndex=",L=function(e){return T+e.keyword+z+m.MD+F},R=function(e){var t={inauthor:e.authors,intitle:e.title,subject:e.subject},n=S().flow(S().toPairs,S().filter((function(e){return!(""===e[1])})),S().map((function(e){return N()(e,":")})),S().join("+"));return T+n(t)+z+m.MD+F},W=function(e){return e.keyword?L(e):R(e)},I=n(3029),M=n(2901),O=n(6892);!function(e){e.authors="Autor",e.title="Tytu\u0142",e.subject="Etykiety"}(A||(A={}));var D,P,U,V=[{name:O.C.authors,placeholder:A.authors},{name:O.C.title,placeholder:A.title},{name:O.C.subject,placeholder:A.subject}],B=new(function(){function e(t){(0,I.A)(this,e),this.fields=void 0,this.fields=t}return(0,M.A)(e,[{key:"getPlaceholder",value:function(e){return this.fields.filter((function(t){return t.name===e}))[0].placeholder}},{key:"getSearchFieldsWithInitialValues",get:function(){var e={};for(var t in this.fields)e[this.fields[t].name]="";return e}},{key:"getFields",get:function(){return this.fields}}]),e}())(V),J=n(7273),H=n.n(J),K=n(4320),Y=n.n(K),$=n(4467);!function(e){e.KEYWORD="keyword",e.AUTHORS="authors",e.TITLE="title",e.SUBJECT="subject"}(U||(U={}));var q=(D={},(0,$.A)(D,U.AUTHORS,"Autor"),(0,$.A)(D,U.TITLE,"Tytu\u0142"),(0,$.A)(D,U.SUBJECT,"Etykiety"),(0,$.A)(D,U.KEYWORD,"S\u0142owo kluczowe"),D),X=(P={},(0,$.A)(P,U.AUTHORS,""),(0,$.A)(P,U.TITLE,""),(0,$.A)(P,U.SUBJECT,""),(0,$.A)(P,U.KEYWORD,""),P),Z={isValid:!0,message:""},_=function(e){var t,n=Z,r=[],o=H()(e);if(!Y()(o))for(var i in o)if(!1===((t=o[i]).length>=2&&/\d|[A-z]/.test(t))){var s=B.getPlaceholder(i);n={isValid:!1,message:"Nieprawid\u0142owe dane w polu "+s},r.push(s)}return!1===n.isValid&&(n.message="Nieprawid\u0142owe warto\u015bci w polach: "+r.join(", ")),n},G=function(e){var t="https://www.googleapis.com/books/v1/volumes?q=",n="&maxResults=1",r={inauthor:e.authors,intitle:e.title,subject:e.subject},o=S().flow(S().toPairs,S().filter((function(e){return!(""===e[1])})),S().map((function(e){return N()(e,":")})),S().join("+"));return e.keyword?t+e.keyword+n:t+o(r)+n},Q=function(e){if(e.keyword){var t=(0,r.A)({},e);for(var n in delete t.keyword,t)t[n]||delete t[n];return t}},ee=n(2606),te=n(2442),ne=n(9394),re=n(4584),oe=function(){return(0,i.useMemo)((function(){return new Worker(new URL(n.p+n.u(291),n.b))}),[])},ie=function(e,t,n){var r=(0,i.useMemo)((function(){return t}),[]),o=(0,c.Zp)(),s=(0,b.wv)(),a=s.setIsLoading,u=s.setIsFromNetwork,l=s.storeBooks,f=oe(),k=(0,b.JX)();(0,i.useEffect)((function(){return window.Worker&&e&&e.length&&t&&(a(!0),f.postMessage({arrayOfEndpoints:e}),f.onerror=function(e){k.error("fetchBooksWorker wywo\u0142a\u0142 b\u0142\u0105d: "+e.message)},f.onmessage=function(e){if(e.data.errors&&k.error("Podczas pobierania conajmniej jednej ksi\u0105\u017cki wyst\u0105pi\u0142 b\u0142\u0105d:"+e.data.errors[0]+" \u0141\u0105cznie b\u0142\u0119d\xf3w: "+e.data.errors.length),e.data.books){var r=(0,re.SF)((0,h.Vf)((0,ne.A)(e.data.books)),n);l(r),u(!0),k.success("Poprawnie pobrano ".concat(r.length.toString()," ksi\u0105\u017cek")),o(d.A.books)}e.data.books||e.data.errors.length||k.warning("Nie znaleziono ksi\u0105\u017cek spe\u0142niaj\u0105cych podane kryteria"),null===t||void 0===t||t.abort(),a(!1)}),function(){return null===t||void 0===t?void 0:t.abort()}}),[f,e,r,n])},se=function(){var e=a()(),t=i.useState(Z),n=(0,o.A)(t,2),s=n[0],c=n[1],d=i.useState(""),h=(0,o.A)(d,2),k=h[0],m=h[1],p=i.useState(""),g=(0,o.A)(p,2),j=g[0],y=g[1],A=(0,b.Jv)(void 0),E=(0,o.A)(A,2),S=E[0],C=E[1],N=(0,b.N4)((function(e){return e.loading.isLoading}),u.bN),T=(0,u.d4)(te.tp),z=(0,b.A0)(j,k),F=new AbortController;ie(z,F,S);var L=(0,l.Wx)({initialValues:X,onSubmit:function(e){var t=_(e);c(t),t.isValid&&(m(W(e)),y(G(e)),C(Q(e)))}}),R=L.values,I=L.handleSubmit,M=L.getFieldProps,O=L.handleReset,D=i.useCallback((function(){return""===Object.values(R).join("")}),[R]),P=i.useCallback((function(){c(Z),O(null)}),[]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(ee.LN,{maxWidth:!1,disableGutters:!0,sx:{alignItems:"unset"},children:[(0,w.jsx)(f.M9,{}),(0,w.jsx)(f.Fc,{shouldRender:!s.isValid,alertMessage:s.message}),(0,w.jsxs)(ee.kW,{id:e,children:[(0,w.jsx)(ee.OM,{children:Object.values(U).map((function(e){return(0,w.jsx)(x,(0,r.A)({isDisabled:N,label:q[e]},M(e)),a()())}))}),(0,w.jsxs)(ee.aL,{children:[(0,w.jsx)(f.$n,{form:e,disabled:N||D()||!T,onClick:I,className:"button--ok",type:"submit",children:"Szukaj"}),(0,w.jsx)(f.$n,{disabled:N||D(),onClick:P,className:"button--problem",type:"reset",children:"Wyczy\u015b\u0107"}),(0,w.jsx)(v,{})]})]})]})})}}}]);
//# sourceMappingURL=744.474f7066.chunk.js.map